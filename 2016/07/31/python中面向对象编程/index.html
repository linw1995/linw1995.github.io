<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="linw"><meta name="description" content="对象(Object)基本上可以看作数据（特性）以及由一系列可以存取、操作这些数据的方法所组成的集合。且有以下优点：多态（Polymorphism）：意味着可以对不同类的对象使用同样的操作，他们会像被“试了魔法那般”工作。封装（Encapsulation）：对外部世界隐藏对象"><meta name="keywords" content="Python"><title>python中面向对象编程 · linw1995</title><link rel="icon" href="/favicon.ico"><link rel="canonical" href="http://linw1995.github.io/2016/07/31/python中面向对象编程/"><link rel="alternate" href="/atom.xml" title="linw1995"><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><link rel="stylesheet" href="/css/style.css"></head><body><div id="main"><header><a href="/." class="logo">linw1995</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Home</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/categories/" target="_self">Categories</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">python中面向对象编程</h1><span class="post-time">Jul 31, 2016</span><div id="sidebar" class="post-sidebar"><h3 class="heading">Contents</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、一个简单的类"><span class="toc-text">一、一个简单的类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、定义"><span class="toc-text">1、定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、调用"><span class="toc-text">2、调用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、成员"><span class="toc-text">二、成员</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、类型："><span class="toc-text">1、类型：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1、实例属性"><span class="toc-text">1.1、实例属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2、类属性"><span class="toc-text">1.2、类属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3、私有属性、方法"><span class="toc-text">1.3、私有属性、方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4、特殊属性"><span class="toc-text">1.4、特殊属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-示例"><span class="toc-text">1.5 示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、深入理解类的属性"><span class="toc-text">三、深入理解类的属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、同名的类属性与实例属性"><span class="toc-text">1、同名的类属性与实例属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、属性访问的特殊方法（反射）"><span class="toc-text">2、属性访问的特殊方法（反射）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、属性包装"><span class="toc-text">3、属性包装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#示例"><span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、描述符"><span class="toc-text">4、描述符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1、协议方法"><span class="toc-text">4.1、协议方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2、分类"><span class="toc-text">4.2、分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3、示例"><span class="toc-text">4.3、示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、让实例能像函数一样使用"><span class="toc-text">5、让实例能像函数一样使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#示例-1"><span class="toc-text">示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、类方法与静态方法"><span class="toc-text">四、类方法与静态方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、静态方法（staticmethod）"><span class="toc-text">1、静态方法（staticmethod）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1、定义方法"><span class="toc-text">1.1、定义方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2、特性"><span class="toc-text">1.2、特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3、调用方法"><span class="toc-text">1.3、调用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4、本质"><span class="toc-text">1.4、本质</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5、用法"><span class="toc-text">1.5、用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6、示例"><span class="toc-text">1.6、示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、类方法（classmethod）"><span class="toc-text">2、类方法（classmethod）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1、定义方法"><span class="toc-text">2.1、定义方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2、访问特性"><span class="toc-text">2.2、访问特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3、调用方法"><span class="toc-text">2.3、调用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4、继承特性"><span class="toc-text">2.4、继承特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5、用法"><span class="toc-text">2.5、用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6、示例"><span class="toc-text">2.6、示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、类的特殊方法"><span class="toc-text">五、类的特殊方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、深入理解类"><span class="toc-text">1、深入理解类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、元类（type）"><span class="toc-text">2、元类（type）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1、类的实例化过程"><span class="toc-text">2.1、类的实例化过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2、自定义元类"><span class="toc-text">2.2、自定义元类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3、应用元类"><span class="toc-text">2.3、应用元类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、构造序列"><span class="toc-text">3、构造序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、构造iter"><span class="toc-text">4、构造iter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、构造可比较类"><span class="toc-text">5、构造可比较类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、构造可运算类"><span class="toc-text">6、构造可运算类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、类的继承与方法重载"><span class="toc-text">六、类的继承与方法重载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七、鸭子类型与多态"><span class="toc-text">七、鸭子类型与多态</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八、设计模式"><span class="toc-text">八、设计模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#九、如何通过组合来构建复杂对象"><span class="toc-text">九、如何通过组合来构建复杂对象</span></a></li></ol></div><div class="post-content"><p><strong>对象(Object)</strong>基本上可以看作数据（特性）以及由一系列可以存取、操作这些数据的方法所组成的集合。且有以下优点：</p>
<ul>
<li><strong>多态（Polymorphism）</strong>：意味着可以对不同类的对象使用同样的操作，他们会像被“试了魔法那般”工作。</li>
<li><strong>封装（Encapsulation）</strong>：对外部世界隐藏对象的工作细节，减少代码重复。</li>
<li><strong>继承（Inheritance）</strong>：以通用的类为基础建立专门的类对象。</li>
</ul>
<a id="more"></a>
<blockquote>
<p>Python式编程中，多态也被称作“鸭子类型”（duck typing）<br>出自俗语“如果它像鸭子一样呱呱大叫，走路像鸭子，那么就可以把它当作鸭子”</p>
</blockquote>
<h2 id="一、一个简单的类"><a href="#一、一个简单的类" class="headerlink" title="一、一个简单的类"></a>一、一个简单的类</h2><h3 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>:</span></div><div class="line">	attribute = <span class="string">"value"</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">method</span><span class="params">(self)</span>:</span></div><div class="line">		print(<span class="string">"I'm a method."</span>)</div></pre></td></tr></table></figure>
<h3 id="2、调用"><a href="#2、调用" class="headerlink" title="2、调用"></a>2、调用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 实例化</span></div><div class="line">&gt; instance = SimpleClass()</div><div class="line"><span class="comment"># 属性</span></div><div class="line">&gt; instance.attribute</div><div class="line"><span class="string">"value"</span></div><div class="line">&gt; instance.method()</div><div class="line"><span class="string">"I'm a method."</span></div></pre></td></tr></table></figure>
<h2 id="二、成员"><a href="#二、成员" class="headerlink" title="二、成员"></a>二、成员</h2><h3 id="1、类型："><a href="#1、类型：" class="headerlink" title="1、类型："></a>1、类型：</h3><h4 id="1-1、实例属性"><a href="#1-1、实例属性" class="headerlink" title="1.1、实例属性"></a>1.1、实例属性</h4><p>当类实例化后产生的属性。</p>
<h4 id="1-2、类属性"><a href="#1-2、类属性" class="headerlink" title="1.2、类属性"></a>1.2、类属性</h4><p>类定义时产生的属性，不需要实例化就有的属性，为所有实例共有。</p>
<h4 id="1-3、私有属性、方法"><a href="#1-3、私有属性、方法" class="headerlink" title="1.3、私有属性、方法"></a>1.3、私有属性、方法</h4><p>特殊定义的<strong>属性</strong>，只能在类里面进行调用和修改。<br>命名规则：以双下横线开头，不以双下横线结尾<br>特殊定义的<strong>方法</strong>，只能在类里调用。</p>
<h4 id="1-4、特殊属性"><a href="#1-4、特殊属性" class="headerlink" title="1.4、特殊属性"></a>1.4、特殊属性</h4><p>用来存储类的元数据</p>
<ul>
<li><p>__doc__ ：类文档</p>
</li>
<li><p>__dict__：存储类元数据、属性和方法</p>
</li>
<li><p>__name__：类名</p>
</li>
<li><p>__module__：所属模块名称</p>
</li>
<li><p>__base__：父类名</p>
</li>
</ul>
<h4 id="1-5-示例"><a href="#1-5-示例" class="headerlink" title="1.5 示例"></a>1.5 示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dice</span>:</span></div><div class="line">	<span class="string">"""sample"""</span></div><div class="line">	attr = <span class="string">"something"</span> <span class="comment"># 类属性</span></div><div class="line">	__count = <span class="number">0</span> <span class="comment"># 私有属性、类属性</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">		self.__sides = <span class="number">6</span> <span class="comment"># 私有属性、实例属性</span></div><div class="line">		self.top = <span class="number">1</span> <span class="comment"># 实例属性</span></div><div class="line">		Dice.__count += <span class="number">1</span> <span class="comment"># 在类中调用类属性、私有属性</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">info</span><span class="params">(self)</span>:</span></div><div class="line">		print(<span class="string">"side:"</span>,self.__sides,<span class="string">"top:"</span>,</div><div class="line">			  self.top,<span class="string">"count:"</span>,Dice.__count) <span class="comment"># 私有属性在类中的调用</span></div><div class="line">dice1 = Dice() <span class="comment"># 类的实例化</span></div><div class="line">dice1.info() <span class="comment"># 类的方法调用</span></div><div class="line"><span class="comment"># side: 6 top: 1 count: 1</span></div><div class="line">dice2 = Dice()</div><div class="line">dice2.info()</div><div class="line"><span class="comment"># side: 6 top: 1 count: 2</span></div><div class="line">dice2.top <span class="comment"># 实例属性的调用</span></div><div class="line"><span class="comment"># 1</span></div><div class="line">dice1.__count <span class="comment"># 私有属性的调用</span></div><div class="line"><span class="comment"># AttributeError: 'Dice' object has no attribute '__count'</span></div><div class="line">dice1.attr <span class="comment"># 实例对类属性调用</span></div><div class="line"><span class="comment"># 'something'</span></div><div class="line">Dice.attr <span class="comment">#类对类属性调用</span></div><div class="line"><span class="comment"># 'something'</span></div></pre></td></tr></table></figure>
<h2 id="三、深入理解类的属性"><a href="#三、深入理解类的属性" class="headerlink" title="三、深入理解类的属性"></a>三、深入理解类的属性</h2><h3 id="1、同名的类属性与实例属性"><a href="#1、同名的类属性与实例属性" class="headerlink" title="1、同名的类属性与实例属性"></a>1、同名的类属性与实例属性</h3><p>类属性会被同名的实例属性所屏蔽<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">dice1.attr = <span class="string">'else'</span></div><div class="line">Dice.attr</div><div class="line"><span class="comment"># 'something'</span></div><div class="line">dice1.attr</div><div class="line"><span class="comment"># 'else'</span></div><div class="line"><span class="keyword">del</span> dice1.attr <span class="comment"># 删除同名的实例属性</span></div><div class="line">dice1.attr <span class="comment"># 成功调用其类属性</span></div><div class="line"><span class="comment"># 'something'</span></div></pre></td></tr></table></figure></p>
<h3 id="2、属性访问的特殊方法（反射）"><a href="#2、属性访问的特殊方法（反射）" class="headerlink" title="2、属性访问的特殊方法（反射）"></a>2、属性访问的特殊方法（反射）</h3><p>提供字符串调用方法：</p>
<ul>
<li><p><code>hasattr(obj_name, &#39;属性名/方法名&#39;)</code></p>
</li>
<li><p><code>setattr(obj_name, &#39;属性名&#39;, 值)</code></p>
</li>
<li><p><code>getattr(obj_name, &#39;属性名/方法名&#39;)</code></p>
</li>
</ul>
<h3 id="3、属性包装"><a href="#3、属性包装" class="headerlink" title="3、属性包装"></a>3、属性包装</h3><p>属性包装是为了控制属性的类型或者范围，即虚拟属性。<br>通过装饰器实现的</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a><strong>示例</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dice</span>:</span></div><div class="line">	<span class="comment"># ...</span></div><div class="line"><span class="meta">	@property #属性包装，可读</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">sides</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="keyword">return</span> self.__sides</div><div class="line"></div><div class="line"><span class="meta">	@sides.setter #@&lt;property-name&gt;.setter 控制sides的范围，可写</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">sides</span><span class="params">(self,sides)</span>:</span></div><div class="line">		<span class="keyword">if</span> sides &gt; <span class="number">1</span>:</div><div class="line">			self.__sides = sides</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			print(<span class="string">"设置失败"</span>)</div><div class="line"></div><div class="line">	<span class="comment"># @sides.deleter 可删</span></div></pre></td></tr></table></figure>
<h3 id="4、描述符"><a href="#4、描述符" class="headerlink" title="4、描述符"></a>4、描述符</h3><p>将实现特殊协议方法的类作为另一个类的属性<br>用来拦截和控制属性的访问并可以重复使用</p>
<h4 id="4-1、协议方法"><a href="#4-1、协议方法" class="headerlink" title="4.1、协议方法"></a>4.1、协议方法</h4><ul>
<li><p><code>__get__()</code></p>
</li>
<li><p><code>__set__()</code></p>
</li>
<li><p><code>__delete__()</code></p>
</li>
</ul>
<h4 id="4-2、分类"><a href="#4-2、分类" class="headerlink" title="4.2、分类"></a>4.2、分类</h4><ol>
<li><p>数据描述符（实现全部协议方法）</p>
</li>
<li><p>非数据描述符（实现部分协议方法）</p>
</li>
</ol>
<blockquote>
<p>所有的类成员都是非数据描述符</p>
</blockquote>
<h4 id="4-3、示例"><a href="#4-3、示例" class="headerlink" title="4.3、示例"></a>4.3、示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Unit</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, default=<span class="number">0</span>)</span>:</span></div><div class="line">		self.default = default</div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, instance, owner)</span>:</span></div><div class="line">		<span class="keyword">return</span> self.default</div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__set__</span><span class="params">(self, instance, val)</span>:</span></div><div class="line">		<span class="keyword">if</span> val &gt; <span class="number">0</span>:</div><div class="line">			self.default = val</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			print(<span class="string">"The value must be NonNegative!"</span>)</div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__delete__</span><span class="params">(self, instance)</span>:</span></div><div class="line">		<span class="keyword">del</span> self</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dice</span>:</span></div><div class="line">	__count = Unit()</div><div class="line">	<span class="comment"># ...</span></div></pre></td></tr></table></figure>
<blockquote>
<p>小结：在某种情况下，运用以上方法可以大大减少代码重复</p>
</blockquote>
<h3 id="5、让实例能像函数一样使用"><a href="#5、让实例能像函数一样使用" class="headerlink" title="5、让实例能像函数一样使用"></a>5、让实例能像函数一样使用</h3><p>直接添加<code>__call__</code>方法</p>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">class Dice:</div><div class="line">	# ...</div><div class="line">	def __call__(self)：</div><div class="line">		from random import randrange</div><div class="line">		self.top = randrange(self.__sides)</div><div class="line">		return self.top</div><div class="line"></div><div class="line">dice = Dice()</div><div class="line">dice()</div><div class="line"># 3</div></pre></td></tr></table></figure>
<h2 id="四、类方法与静态方法"><a href="#四、类方法与静态方法" class="headerlink" title="四、类方法与静态方法"></a>四、类方法与静态方法</h2><h3 id="1、静态方法（staticmethod）"><a href="#1、静态方法（staticmethod）" class="headerlink" title="1、静态方法（staticmethod）"></a>1、静态方法（staticmethod）</h3><h4 id="1-1、定义方法"><a href="#1-1、定义方法" class="headerlink" title="1.1、定义方法"></a>1.1、定义方法</h4><p>用装饰器 &#64;staticmethod</p>
<h4 id="1-2、特性"><a href="#1-2、特性" class="headerlink" title="1.2、特性"></a>1.2、特性</h4><p>不能引用或访问实例属性<br>可以通过 &lt;类名&gt;.&lt;类变量名&gt; 访问类属性</p>
<h4 id="1-3、调用方法"><a href="#1-3、调用方法" class="headerlink" title="1.3、调用方法"></a>1.3、调用方法</h4><p>可以用类、类实例调用</p>
<h4 id="1-4、本质"><a href="#1-4、本质" class="headerlink" title="1.4、本质"></a>1.4、本质</h4><p>一个普通函数，只是归于类，易于代码管理</p>
<h4 id="1-5、用法"><a href="#1-5、用法" class="headerlink" title="1.5、用法"></a>1.5、用法</h4><p>用来创建不同的实例，或者把类相关的工具方法放在类中。</p>
<h4 id="1-6、示例"><a href="#1-6、示例" class="headerlink" title="1.6、示例"></a>1.6、示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dice</span>:</span></div><div class="line">	<span class="comment"># ...</span></div><div class="line"><span class="meta">	@staticmethod</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">cube</span><span class="params">()</span>:</span></div><div class="line">		cube = Dice()</div><div class="line">		cube.sides = <span class="number">6</span></div><div class="line">		<span class="keyword">return</span> cube</div></pre></td></tr></table></figure>
<h3 id="2、类方法（classmethod）"><a href="#2、类方法（classmethod）" class="headerlink" title="2、类方法（classmethod）"></a>2、类方法（classmethod）</h3><h4 id="2-1、定义方法"><a href="#2-1、定义方法" class="headerlink" title="2.1、定义方法"></a>2.1、定义方法</h4><p>用装饰器 &#64;classmethod<br>但必须提供参数cls</p>
<h4 id="2-2、访问特性"><a href="#2-2、访问特性" class="headerlink" title="2.2、访问特性"></a>2.2、访问特性</h4><p>不能引用或访问实例属性</p>
<h4 id="2-3、调用方法"><a href="#2-3、调用方法" class="headerlink" title="2.3、调用方法"></a>2.3、调用方法</h4><p>可以用类、类实例调用</p>
<h4 id="2-4、继承特性"><a href="#2-4、继承特性" class="headerlink" title="2.4、继承特性"></a>2.4、继承特性</h4><p>继承时，传入的类变量cls是子类，而非父类</p>
<h4 id="2-5、用法"><a href="#2-5、用法" class="headerlink" title="2.5、用法"></a>2.5、用法</h4><p>制作工厂方法<br>创建不同的类实例<br>在类中调用时不需要使用类名。</p>
<h4 id="2-6、示例"><a href="#2-6、示例" class="headerlink" title="2.6、示例"></a>2.6、示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dice</span>:</span></div><div class="line">	<span class="comment"># ...</span></div><div class="line"><span class="meta">	@classmethod</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">cube</span><span class="params">(cls)</span>:</span></div><div class="line">		cube = cls()</div><div class="line">		cube.sides = <span class="number">6</span></div><div class="line">		<span class="keyword">return</span> cube</div></pre></td></tr></table></figure>
<h2 id="五、类的特殊方法"><a href="#五、类的特殊方法" class="headerlink" title="五、类的特殊方法"></a>五、类的特殊方法</h2><h3 id="1、深入理解类"><a href="#1、深入理解类" class="headerlink" title="1、深入理解类"></a>1、深入理解类</h3><p>类也是一个对象，单据有创建其自身实例的能力。<br>类可以和一个变量进行绑定，函数也行，这为类添加了属性、方法。<br>还可以把类当作函数的参数。</p>
<h3 id="2、元类（type）"><a href="#2、元类（type）" class="headerlink" title="2、元类（type）"></a>2、元类（type）</h3><blockquote>
<p>类的创建和管理者————type<br>所有类都是元类（type）的实例</p>
</blockquote>
<h4 id="2-1、类的实例化过程"><a href="#2-1、类的实例化过程" class="headerlink" title="2.1、类的实例化过程"></a>2.1、类的实例化过程</h4><ul>
<li><p><code>__new__()</code>创建实例</p>
</li>
<li><p><code>__init__()</code>实例初始化</p>
</li>
</ul>
<p>示例：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomClass</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">		print(<span class="string">'Init something...'</span>)</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kwargs)</span>:</span></div><div class="line">		print(<span class="string">'New Instance.'</span>)</div><div class="line">		<span class="keyword">return</span> object.__new__(cls, *args, **kwargs)</div></pre></td></tr></table></figure></p>
<h4 id="2-2、自定义元类"><a href="#2-2、自定义元类" class="headerlink" title="2.2、自定义元类"></a>2.2、自定义元类</h4><p>目的：对其创建的类进行预处理<br>定义方法：</p>
<ol>
<li><p>继承type</p>
</li>
<li><p>定义<code>__new__()</code>方法</p>
</li>
<li><p>定义<code>__init__()</code>方法（可选）</p>
</li>
</ol>
<p>示例：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyMeta</span><span class="params">(type)</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, bases, dicts)</span>:</span></div><div class="line">		print(<span class="string">'Init Something...'</span>)</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, bases, dicts)</span>:</span></div><div class="line">		dicts[<span class="string">'hello'</span>] = <span class="keyword">lambda</span> self:print(<span class="string">'Hello'</span>)</div><div class="line">		result = type.__new__(cls, name, bases, dicts)</div><div class="line">		result.greet = <span class="keyword">lambda</span> self:print(<span class="string">'Greet'</span>)</div><div class="line">		<span class="keyword">return</span> result</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomClass</span><span class="params">(metaclass=MyMeta)</span>:</span></div><div class="line">	<span class="keyword">pass</span></div><div class="line"></div><div class="line">cus = CustomClass()</div><div class="line">cus.hello()</div><div class="line"><span class="comment"># Hello</span></div><div class="line">cus.greet()</div><div class="line"><span class="comment"># Greet</span></div></pre></td></tr></table></figure></p>
<h4 id="2-3、应用元类"><a href="#2-3、应用元类" class="headerlink" title="2.3、应用元类"></a>2.3、应用元类</h4><ul>
<li>Python 3.x：</li>
</ul>
<p>在类继承中提供关键字参数： metaclass=元类名</p>
<ul>
<li>Python 2.x:把旧式类转变为新式类</li>
</ul>
<p>定义一个模块级变量<strong>metaclass</strong>=元类名<br>为某个类添加类属性<strong>metaclass</strong>=元类名</p>
<h3 id="3、构造序列"><a href="#3、构造序列" class="headerlink" title="3、构造序列"></a>3、构造序列</h3><p>只需要构造四个方法：</p>
<ul>
<li><p><code>__len__(self)</code></p>
</li>
<li><p><code>__getitem__(self, key)</code></p>
</li>
<li><p><code>__setitem__(self, key, value)</code></p>
</li>
<li><p><code>__delitem__(self, key)</code></p>
<h3 id="4、构造iter"><a href="#4、构造iter" class="headerlink" title="4、构造iter"></a>4、构造iter</h3><p>要构造一个可迭代对象，只需要构造两个方法：</p>
</li>
<li><p><code>__iter__(self)</code></p>
</li>
<li><p><code>__next__(self)</code></p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyIter</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,start,end)</span>:</span></div><div class="line">		self.count = start - <span class="number">1</span></div><div class="line">		self.end = end</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="keyword">return</span> self</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__next__</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="keyword">if</span> self.count &lt; self.end:</div><div class="line">			self.count += <span class="number">1</span></div><div class="line">			<span class="keyword">return</span> self.count</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="keyword">raise</span> StopIteration</div></pre></td></tr></table></figure>
<h3 id="5、构造可比较类"><a href="#5、构造可比较类" class="headerlink" title="5、构造可比较类"></a>5、构造可比较类</h3><p>需要两个参数，本身及比较对象，返回布尔值。</p>
<ul>
<li><p><code>__lt__()</code> 小于</p>
</li>
<li><p><code>__le__()</code> 小于等于</p>
</li>
<li><p><code>__gt__()</code> 大于</p>
</li>
<li><p><code>__ge__()</code> 大于等于</p>
</li>
<li><p><code>__eq__()</code> 等于</p>
</li>
<li><p><code>__ne__()</code> 不等于</p>
</li>
</ul>
<h3 id="6、构造可运算类"><a href="#6、构造可运算类" class="headerlink" title="6、构造可运算类"></a>6、构造可运算类</h3><p>需要两个参数，本身及运算对象，返回新的对象。</p>
<ul>
<li><p><code>__add__()</code></p>
</li>
<li><p><code>__sub__()</code></p>
</li>
<li><p><code>__mul__()</code></p>
</li>
<li><p><code>__div__()</code></p>
</li>
</ul>
<h2 id="六、类的继承与方法重载"><a href="#六、类的继承与方法重载" class="headerlink" title="六、类的继承与方法重载"></a>六、类的继承与方法重载</h2><h2 id="七、鸭子类型与多态"><a href="#七、鸭子类型与多态" class="headerlink" title="七、鸭子类型与多态"></a>七、鸭子类型与多态</h2><h2 id="八、设计模式"><a href="#八、设计模式" class="headerlink" title="八、设计模式"></a>八、设计模式</h2><h2 id="九、如何通过组合来构建复杂对象"><a href="#九、如何通过组合来构建复杂对象" class="headerlink" title="九、如何通过组合来构建复杂对象"></a>九、如何通过组合来构建复杂对象</h2></div></article><div class="tags"><a href="/tags/Python/">Python</a></div><div class="paginator"><a href="/2016/10/02/搭梯子-简单教程/" class="prev"><i class="iconfont icon-left"></i><span> Prev</span></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://linw1995.github.io/2016/07/31/python中面向对象编程/';
    this.page.identifier = '2016/07/31/python中面向对象编程/';
    this.page.title = 'python中面向对象编程';
};
(function() {
var d = document, s = d.createElement('script');

s.src = '//linw1995.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();</script></section><footer><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">linw</span></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>